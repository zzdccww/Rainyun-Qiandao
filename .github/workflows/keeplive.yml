name: ä»“åº“ä¿æ´»ä»»åŠ¡
on:
  schedule:
    - cron: '0 0 */20 * *'  # æ¯14å¤©0ç‚¹ï¼ˆUTCï¼‰è¿è¡Œä¸€æ¬¡
  workflow_dispatch:         # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  keepalive:
    runs-on: ubuntu-latest
    permissions:
      contents: write  # éœ€è¦å†™æƒé™æ¥æ¨é€æäº¤
    
    steps:
      - name: ğŸ“¥ æ£€å‡ºä»£ç 
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
    
      - name: ğŸ”„ æ›´æ–°ä¿æ´»æ—¶é—´æˆ³
        run: |
          # åˆ›å»ºæˆ–æ›´æ–°ä¸€ä¸ªä¸“é—¨ç”¨äºä¿æ´»çš„æ–‡ä»¶
          # æ¯”å¦‚æ›´æ–°ä¸€ä¸ªæ—¶é—´æˆ³
          echo "Last keep-alive: $(date -u '+%Y-%m-%d %H:%M:%S UTC')" > .github/keepalive.txt
      
      - name: ğŸ“¤ æäº¤å¹¶æ¨é€å˜æ›´
        run: |
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git config --global user.name "github-actions[bot]"
          
          git add .github/keepalive.txt
          
          # æ£€æŸ¥æ˜¯å¦æœ‰å®é™…å˜æ›´
          if git diff --staged --quiet; then
            echo "æ²¡æœ‰å˜æ›´ï¼Œè·³è¿‡æäº¤"
          else
            git commit -m "chore: æ›´æ–°ä»“åº“ä¿æ´»æ—¶é—´æˆ³ [skip ci]"
            git push
            echo "âœ… ä¿æ´»æ—¶é—´æˆ³å·²æ›´æ–°"
          fi
